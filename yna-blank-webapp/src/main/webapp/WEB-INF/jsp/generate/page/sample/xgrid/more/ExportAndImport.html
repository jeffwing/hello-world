<style type="text/css" scoped>
	.vue-form.escort-vue.escort-vue-form {
		padding: 8px;
	}

	.tip .vue-note__description {
		font-size: 14px;
		color: black;
	}

	.red {
		color: red;
	}
</style>
<template>
	<div v-cloak class="page" v-loading="pageLoading" :vue-loading-text="messageutil.get('page.loading.text')">
		<escort-form ref="form" id="form" :model="form">
			<escort-notice :show-content="true" title=" " cls="tip" id="vueNotice_reycm" ref="vueNotice_reycm"> 导出数据：通过调用 exportData 函数指定 type="csv" 可以直接将表格导出为 CSV/HTML/XML/TXT/XLSX 格式的文件； <br>默认会排除 field 为空和 type 相关的功能列，可以通过自定义 data 和 columns 导出数据<br /><br />导入数据：通过 importData 函数可以直接将数据导入表格中<br><span class="red">（注：附件中的字段名必须和表格一致，数据格式不正确将无法导入）</span>
			</escort-notice>
			<escort-xgrid :pageable="true" :height="gridHeight" id="expImpXgrid" ref="expImpXgrid" :data="grid.data" data-field="datas" :datasource="grid" total-field="total" :edit-config="{ trigger: 'dblclick' }" :toolbar="{ id:'expImpXgridToolbar' ,import: true ,export: true ,refresh: true }">
				<template slot="buttons">
					<escort-button type="primary" id="vueButton_vxQ3m" ref="vueButton_vxQ3m" @click="vueButton_vxQ3mClick"> 导出excel </escort-button>
					<escort-button type="primary" id="vueButton_4p3AU2" ref="vueButton_4p3AU2" @click="vueButton_4p3AU2Click"> 导出html </escort-button>
					<escort-button type="primary" id="vueButton_4f0zCq" ref="vueButton_4f0zCq" @click="vueButton_4f0zCqClick"> 高级导出 </escort-button>
					<escort-button type="primary" id="vueButton_4f0ydE" ref="vueButton_4f0ydE" @click="vueButton_4f0ydEClick"> 导入 </escort-button>
					<escort-button type="primary" id="vueButton_4f0wx8" ref="vueButton_4f0wx8" @click="vueButton_4f0wx8Click"> 高级导入 </escort-button>
				</template>
				<escort-xgrid-column type="index" align="center" width="50px" min-width="50px">
				</escort-xgrid-column>
				<escort-xgrid-column align="center" type="checkbox" width="50px">
				</escort-xgrid-column>
				<escort-xgrid-column prop="userName" text="姓名" width="180px" render-name="input">
				</escort-xgrid-column>
				<escort-xgrid-column prop="personNo" text="编号" width="180px" render-name="input">
				</escort-xgrid-column>
				<escort-xgrid-column render-name="numeric" :edit-render-attrs-cleave="expImpXgridAgeCleave" prop="age" align="right" width="180px" text="年龄">
				</escort-xgrid-column>
				<escort-xgrid-column render-name="date" edit-render-attrs-type="date" prop="date" align="center" text="入社日期" width="180px">
				</escort-xgrid-column>
			</escort-xgrid>
		</escort-form>
	</div>
</template>
<script type="text/javascript">
	var pageMixins;
	(function() {
		var pageMixinMap = {};
		pageMixinMap.event = {
			methods: {
				vueButton_vxQ3mClick: function(event) {
					this.getRef('expImpXgrid').exportData({
						type: 'xlsx'
					});
				},
				vueButton_4p3AU2Click: function(event) {
					this.getRef('expImpXgrid').exportData({
						type: 'html'
					});
				},
				vueButton_4f0zCqClick: function(event) {
					this.getRef('expImpXgrid').openExport();
				},
				vueButton_4f0ydEClick: function(event) {
					this.getRef('expImpXgrid').importData();
				},
				vueButton_4f0wx8Click: function(event) {
					this.getRef('expImpXgrid').openImport();
				},
				gridParameter: function() {
					return this.form;
				}
			}
		};
		pageMixinMap.manualSeperate = {
			data: function() {
				return {
					gridHeight: 0
				};
			},
			created: function() {
				var thiz = this;
				window.onresize = function() {
					thiz.autoSetGridHeight();
				};
			},
			mounted: function() {
				this.autoSetGridHeight();
			},
			methods: {
				autoSetGridHeight: function() {
					var winHeight = 0;
					if (window.innerHeight) {
						winHeight = window.innerHeight;
					} else if ((document.body) && (document.body.offsetHeight)) {
						winHeight = document.body.offsetHeight;
					}
					if (document.documentElement && document.documentElement.offsetHeight) {
						winHeight = document.documentElement.offsetHeight;
					}
					var vueNoticeHeight = this.getRef('vueNotice_reycm').$el.offsetHeight;
					var frameHeight = 0; //Compatible height calculation of page and page template
					if (document.getElementsByClassName('navbar').length > 0) {
						frameHeight += document.getElementsByClassName('navbar')[0].offsetHeight;
					}
					if (document.getElementsByClassName('tags-view-container').length > 0) {
						frameHeight += document.getElementsByClassName('tags-view-container')[0].offsetHeight;
					}
					this.gridHeight = winHeight - vueNoticeHeight - frameHeight - 16;
				}
			}
		};
		pageMixinMap.auto = {
			data: function() {
				return {
					pageLoading: false,
					form: {},
					expImpXgridAgeCleave: {
						numeralDecimalScale: '0'
					},
					grid: this.getDataSource({
						url: "/xgrid/search.json",
						type: "POST",
						parameter: this.gridParameter
					})
				};
			},
			mounted: function() {
				this.grid.retrieve();
			}
		};
		pageMixins = getPageMixins(pageMixinMap);
	})();
	module.exports = {
		mixins: pageMixins,
		name: "ExportAndImport"
	};
</script>